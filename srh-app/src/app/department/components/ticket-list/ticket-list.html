<div class="ticket-container">
  <h2>🎫 Department Ticket Viewer</h2>
  <img
    src="https://assets.upstox.com/content/assets/images/cms/2024314/coforge.webp"
    alt="Logo"
    class="top-right-logo"
  />

  <div class="form-group">
    <label for="deptId">Select Department:</label>
    <select id="deptId" [(ngModel)]="departmentId" class="styled-select">
      <option [value]="0" disabled selected>Select Department</option>
      <option [value]="1">IT Support</option>
      <option [value]="2">Non IT Support</option>
      <option [value]="3">HR Support</option>
    </select>
    <button (click)="fetchTickets()">Fetch Tickets</button>
  </div>

  <p class="error" *ngIf="isError">{{ errorMsg }}</p>
  <p class="loading" *ngIf="loading">Loading tickets...</p>

  <div class="table-wrapper" *ngIf="!isError && tickets.length > 0">
    <div class="ticket-cards-container">
      <div class="ticket-card" *ngFor="let ticket of tickets">
        <div class="ticket-header">
          <div class="ticket-id">ID: {{ ticket.ticketId }}</div>
          <div class="status {{ ticket.status | lowercase }}">
            {{ ticket.status }}
          </div>
        </div>

        <div class="ticket-description">{{ ticket.description }}</div>

        <div class="ticket-dates">
          <div>Created: {{ ticket.createdAt | date: 'short' }}</div>
          <div>Updated: {{ ticket.updatedAt | date: 'short' }}</div>
        </div>

        <div class="ticket-comments" *ngIf="ticket.comments?.length > 0">
          <strong>Comments:</strong>
          <ul>
            <li *ngFor="let comment of ticket.comments">
              <strong>{{ comment.commenterName }}:</strong> {{ comment.commentText }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<a class="back-arrow" href="home">← Back</a>
<footer>
  <p>© 2025 Department Ticketing System | Version 1.0</p>
</footer>
