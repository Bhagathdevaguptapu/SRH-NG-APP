<a class="back-link" href="home">← Back</a>
<img src="https://assets.upstox.com/content/assets/images/cms/2024314/coforge.webp" alt="Logo" class="top-right-logo" />

<div class="card-container">
  <div class="comment-card">
    <div class="comment-left">
      <h2>Add Comment</h2>

<!-- Department Dropdown -->
<div class="form-group">
  <select id="deptId" [(ngModel)]="selectedDepartmentId" (change)="fetchDepartmentTickets()" required>
    <option value="" disabled>Select Department</option>
    <option [value]="1">IT Support</option>
    <option [value]="2">Non IT Support</option>
    <option [value]="3">HR Support</option>
  </select>
  <label for="deptId">Select Department</label>
</div>

<!-- Ticket Dropdown -->
<div class="form-group" *ngIf="departmentTickets.length > 0">
  <select id="ticketId" [(ngModel)]="ticketId" required>
    <option value="" disabled>Select Ticket</option>
    <option *ngFor="let t of departmentTickets" [value]="t.ticketId">
      {{ t.ticketId }} - {{ t.subject || t.description | slice:0:30 }}...
    </option>
  </select>
  <label for="ticketId">Select Ticket</label>
</div>


      <!-- Name input -->
      <div class="form-group">
        <input type="text" id="commenterName" [(ngModel)]="commenterName" placeholder=" " required />
        <label for="commenterName">Your Name</label>
      </div>

      <!-- Comment input -->
      <div class="form-group">
        <textarea id="commentText" [(ngModel)]="commentText" placeholder=" " required></textarea>
        <label for="commentText">Comment</label>
      </div>

      <!-- Submit -->
      <button (click)="submitComment()" [disabled]="loading">Submit</button>

      <!-- Feedback -->
      <p class="loading" *ngIf="loading">Submitting comment...</p>
      <p class="error" *ngIf="isError">{{ errorMsg }}</p>
      <p class="success" *ngIf="successMsg">{{ successMsg }}</p>
    </div>

    <div class="comment-right">
      <img
        src="https://previews.123rf.com/images/rastudio/rastudio2211/rastudio221100203/193897277-software-tester-isolated-cartoon-vector-illustrations.jpg"
        alt="Illustration"
      />
    </div>
  </div>
</div>

<footer>
  <p>© 2025 Department Ticketing System | Version 1.0</p>
</footer>
